#!/bin/bash
set -eo pipefail

mysqld &

echo "Waiting for MySQL to start..."
until echo exit | telnet localhost 3306 > /tmp/mysql_connect.out  2>&1 ; grep "Connected to localhost" /tmp/mysql_connect.out; do
 printf '.'
 sleep 1
done

# Update configuration
bahmni -i local update-config

# Start Bahmni
bahmni -i local start

log_root=/var/log

tail -f $log_root/openmrs/* $log_root/openerp/* $log_root/bahmni-*/*